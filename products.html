<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Petshop Chiquitines - Explora nuestro catálogo de productos para mascotas: alimentos, accesorios, juguetes y más para perros, gatos y otras mascotas. Compra online de manera fácil y segura.">
    <meta name="robots" content="index, follow">
    <title>Productos - Petshop Chiquitines</title>
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <!-- Desktop Navigation (Centered) -->
                <nav class="nav-desktop">
                    <a href="index.html" class="nav-link">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        </svg>
                        <span>Inicio</span>
                    </a>
                    <a href="products.html" class="nav-link active">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                        </svg>
                        <span>Productos</span>
                    </a>
                </nav>

                <!-- Cart Icon (Right) -->
                <div class="header-actions">
                    <a href="cart.html" class="cart-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="9" cy="21" r="1"></circle>
                            <circle cx="20" cy="21" r="1"></circle>
                            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                        </svg>
                        <span class="cart-count" id="cartCount">0</span>
                    </a>
                    <button class="mobile-menu-btn" id="mobileMenuBtn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="3" y1="12" x2="21" y2="12"></line>
                            <line x1="3" y1="6" x2="21" y2="6"></line>
                            <line x1="3" y1="18" x2="21" y2="18"></line>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div class="mobile-menu" id="mobileMenu">
            <nav>
                <a href="index.html" class="mobile-nav-link">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    </svg>
                    <span>Inicio</span>
                </a>
                <a href="products.html" class="mobile-nav-link">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                    </svg>
                    <span>Productos</span>
                </a>
            </nav>
        </div>
    </header>

    <!-- Products Page -->
    <div class="products-page">
        <div class="container">
            <div class="section-header">
                <h1>Todos los Productos</h1>
                <p>Encuentra todo lo que necesita tu mascota</p>
            </div>

            <!-- Search Bar -->
            <div class="search-bar">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                </svg>
                <input 
                    type="text" 
                    id="searchInput" 
                    placeholder="Buscar productos, marcas, categorías..."
                    oninput="applyFilters()">
            </div>

            <!-- Filter Toggle (Mobile) -->
            <button class="filter-toggle-btn" id="filterToggleBtn">
                <div class="filter-toggle-content">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                    </svg>
                    <span>Filtros</span>
                    <span class="filter-count" id="filterCount" style="display: none;">0</span>
                </div>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
            </button>

            <div class="products-layout">
                <!-- Filters Sidebar -->
                <aside class="filters-sidebar mobile-hidden" id="filtersSidebar">
                    <div class="filters-header">
                        <h3>Filtros</h3>
                        <button class="clear-filters-btn" id="clearFiltersBtn" onclick="clearFilters()">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="18" y1="6" x2="6" y2="18"></line>
                                <line x1="6" y1="6" x2="18" y2="18"></line>
                            </svg>
                            <span>Limpiar</span>
                        </button>
                    </div>

                    <div class="filter-group">
                        <label>Categoría</label>
                        <select id="categoryFilter" onchange="applyFilters()">
                            <option value="">Todas</option>
                            <option value="alimentos">Alimentos</option>
                            <option value="higiene">Higiene</option>
                            <option value="salud">Salud</option>
                            <option value="accesorios">Accesorios</option>
                            <option value="juguetes">Juguetes</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label>Tipo de Mascota</label>
                        <select id="petTypeFilter" onchange="applyFilters()">
                            <option value="">Todas</option>
                            <option value="perro">Perro</option>
                            <option value="gato">Gato</option>
                            <option value="ave">Ave</option>
                            <option value="roedor">Roedor</option>
                            <option value="todos">Todos</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label>Marca</label>
                        <select id="brandFilter" onchange="applyFilters()">
                            <option value="">Todas</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label>Ordenar por</label>
                        <select id="sortFilter" onchange="applyFilters()">
                            <option value="">Más recientes</option>
                            <option value="price-asc">Precio: Menor a Mayor</option>
                            <option value="price-desc">Precio: Mayor a Menor</option>
                            <option value="name-asc">Nombre: A-Z</option>
                            <option value="name-desc">Nombre: Z-A</option>
                        </select>
                    </div>
                </aside>

                <!-- Products Grid -->
                <div class="products-main">
                    <div class="products-count" id="productsCount">Cargando...</div>
                    <div id="productsGrid" class="products-grid">
                        <div class="loading-skeleton"></div>
                        <div class="loading-skeleton"></div>
                        <div class="loading-skeleton"></div>
                        <div class="loading-skeleton"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p class="copyright">© 2026 Chiquitines. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script src="app.js"></script>
    <script>
        let allProducts = [];
        let filteredProducts = [];

        document.addEventListener('DOMContentLoaded', function() {
            loadProducts();
            setupFilterToggle();
        });

        async function loadProducts() {
    try {
        const archivos = ['products1.json', 'products2.json'];

        const resultados = await Promise.all(
            archivos.map(archivo => fetch(archivo).then(r => r.json()))
        );

        allProducts = resultados.flat();

        // Lo demás queda IGUAL ↓
        const brands = [...new Set(allProducts.map(p => p.brand).filter(Boolean))].sort();
        const brandFilter = document.getElementById('brandFilter');
        brands.forEach(brand => {
            const option = document.createElement('option');
            option.value = brand;
            option.textContent = brand;
            brandFilter.appendChild(option);
        });

        applyFilters();
    } catch (error) {
        console.error('Error loading products:', error);
        document.getElementById('productsGrid').innerHTML = 
            '<div class="empty-state"><p>Error al cargar productos</p></div>';
    }
}

        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const category = document.getElementById('categoryFilter').value;
            const petType = document.getElementById('petTypeFilter').value;
            const brand = document.getElementById('brandFilter').value;
            const sort = document.getElementById('sortFilter').value;

            filteredProducts = [...allProducts];

            // Search filter
            if (searchTerm) {
                filteredProducts = filteredProducts.filter(p =>
                    p.name?.toLowerCase().includes(searchTerm) ||
                    p.description?.toLowerCase().includes(searchTerm) ||
                    p.brand?.toLowerCase().includes(searchTerm) ||
                    p.category?.toLowerCase().includes(searchTerm)
                );
            }

            // Category filter
            if (category) {
                filteredProducts = filteredProducts.filter(p => p.category === category);
            }

            // Pet type filter
            if (petType) {
                filteredProducts = filteredProducts.filter(p => 
                    p.petType === petType || p.petType === 'todos'
                );
            }

            // Brand filter
            if (brand) {
                filteredProducts = filteredProducts.filter(p => p.brand === brand);
            }

            // Sorting
            if (sort === 'price-asc') {
                filteredProducts.sort((a, b) => a.price - b.price);
            } else if (sort === 'price-desc') {
                filteredProducts.sort((a, b) => b.price - a.price);
            } else if (sort === 'name-asc') {
                filteredProducts.sort((a, b) => a.name.localeCompare(b.name));
            } else if (sort === 'name-desc') {
                filteredProducts.sort((a, b) => b.name.localeCompare(a.name));
            }

            displayProducts();
            updateFilterCount();
        }

        function displayProducts() {
            const grid = document.getElementById('productsGrid');
            const count = document.getElementById('productsCount');

            count.textContent = `${filteredProducts.length} productos encontrados`;

            if (filteredProducts.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state">
                        <p>No se encontraron productos</p>
                        <button onclick="clearFilters()">Limpiar filtros</button>
                    </div>
                `;
                return;
            }

            grid.innerHTML = filteredProducts.map(product => createProductCard(product)).join('');
        }

        function clearFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('categoryFilter').value = '';
            document.getElementById('petTypeFilter').value = '';
            document.getElementById('brandFilter').value = '';
            document.getElementById('sortFilter').value = '';
            applyFilters();
        }

        function updateFilterCount() {
            const activeFilters = [
                document.getElementById('categoryFilter').value,
                document.getElementById('petTypeFilter').value,
                document.getElementById('brandFilter').value,
                document.getElementById('sortFilter').value
            ].filter(Boolean).length;

            const filterCount = document.getElementById('filterCount');
            if (activeFilters > 0) {
                filterCount.textContent = activeFilters;
                filterCount.style.display = 'inline-block';
            } else {
                filterCount.style.display = 'none';
            }
        }

        function setupFilterToggle() {
            const toggleBtn = document.getElementById('filterToggleBtn');
            const sidebar = document.getElementById('filtersSidebar');

            if (toggleBtn && sidebar) {
                toggleBtn.addEventListener('click', function() {
                    sidebar.classList.toggle('mobile-hidden');
                });
            }
        }
    </script>
</body>
</html>
